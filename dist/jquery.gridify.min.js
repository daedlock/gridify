/*! gridify - v1.0.0 - 2015-05-01
* Copyright (c) 2015 Hossam Saraya; Licensed MIT */
!function(a){var b={arrows:{left:".arrow",right:".arrow",top:".arrow",bottom:".arrow"},pageSelector:".page",pagesPerRow:3,arrowKeysEnabled:!0,onAfterPageSlide:function(a,b){},onBeforePageSlide:function(a,b){}},c=function(c,d){this.settings=a.extend({},b,d),this.gridRoot=c,this.init()};c.prototype={initData:function(){this.body=a("body"),this.arrows=a([this.settings.arrows.left,this.settings.arrows.right,this.settings.arrows.top,this.settings.arrows.bottom].join(",")),this.cameraPosition={x:0,y:0},this.currentIndex={i:0,j:0},this.pages=this.gridRoot.find(this.settings.pageSelector)},init:function(){this.initData(),this.bindArrowKeys(),this.redraw();var b=this;a(window).resize(function(){b.redraw()})},bindArrowKeys:function(){if(this.settings.arrowKeysEnabled){var b=this;a(document).keydown(function(a){switch(a.which){case 37:b.moveToPage(b.currentIndex.i,b.currentIndex.j-1);break;case 38:b.moveToPage(b.currentIndex.i-1,b.currentIndex.j);break;case 39:b.moveToPage(b.currentIndex.i,b.currentIndex.j+1);break;case 40:b.moveToPage(b.currentIndex.i+1,b.currentIndex.j);break;default:return}a.preventDefault()})}},moveToPage:function(a,b){if(0>a||0>b||b+1>this.settings.pagesPerRow||a+1>Math.ceil(this.pages.length/this.settings.pagesPerRow))return!1;this.settings.onBeforePageSlide(this.currentIndex.i,this.currentIndex.j);var c=window.innerWidth,d=window.innerHeight,e=this;this.cameraPosition.x=-b*c,this.cameraPosition.y=-a*d,this.currentIndex.j=b,this.currentIndex.i=a,this.body.velocity({scale:.7,opacity:.7},{}),this.arrows.velocity({opacity:0}),this.pages.velocity({scale:.95}),this.gridRoot.velocity({translateX:e.cameraPosition.x,translateY:e.cameraPosition.y},{delay:300,easing:[.71,-.58,.29,1.57]}),this.body.velocity({scale:1,opacity:1},{delay:300,complete:function(){e.settings.onAfterPageSlide(e.currentIndex.i,e.currentIndex.j)}}),this.pages.velocity({scale:1},{delay:300}),this.arrows.velocity({opacity:1},{delay:360})},redraw:function(){this.cameraPosition.x=-this.currentIndex.j*window.innerWidth,this.cameraPosition.y=-this.currentIndex.i*window.innerHeight,this.gridRoot.css({transform:"translateX("+this.cameraPosition.x+"px) translateY("+this.cameraPosition.y+"px)"});var b=this;return this.pages.each(function(c,d){a(d).css({position:"fixed",overflow:"scroll",zIndex:-1,top:Math.floor(c/b.settings.pagesPerRow)*window.innerHeight,bottom:0,left:c%b.settings.pagesPerRow*window.innerWidth,width:window.innerWidth,minHeight:window.innerHeight})})}},a.Gridify=c}(jQuery);